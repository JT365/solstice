<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Solstice i2c Bus Reverse Engineering Tool</title>
<script type="text/javascript" src="solstice.js"></script>
</head>

<body>
  <form name="mainForm">
  	<div>
<label for="cheese">Solstice i2c Bus Reverse Engineering Tool</label>	
  	</div>
 	<div>
<label for="cheese">v1.0</label>	
  	</div>
 	<div>
<label for="cheese">by NXElec Co., Ltd.</label> 		
  	</div>  	  	
<div>
<label for="cheese">i2c Slave Address</label>	  
  	<input name="address" value="0x0F">
</div>
  <div>
 <label for="cheese">Remove redundant transactions</label>	  
  	<input type="checkbox" name="Redundant">
</div>
 
<div>
   
 <label for="cheese">Include Register Filters</label>	  
  	<input type="checkbox" name="Include">

  	<input name="IncludeAddr" value="0x0F">

 <label for="cheese">Exclude Register Filters</label>	  
  	<input type="checkbox" name="Exclude">
  
  	<input name="ExcludeAddr" value="0x0F">

</div>
    <div>
      <input id="fileInput" type="file" name="transactions" >
      total size: <span id="fileSize">0</span>

  </form>

  <script>
async function prepareData() {
    const file = this.files[0];
    if (!file) return;

    try {
        // 1. Use the modern Blob.text() API (cleaner than FileReader)
        const text = await file.text();

        // 2. Chain operations: split -> trim -> filter empty -> split columns
        const rawData = text
            .split(/\r?\n/) 
            .map(row => row.trim())
            .filter(row => row.length > 0) // Truly removes empty lines
            .map(row => row.split(','));

        if (rawData.length > 0) {
            processData(rawData);
        }
    } catch (err) {
        console.error("File reading failed:", err);
    }
}

  document.getElementById("fileInput").addEventListener("change", prepareData, false);
  </script>
</body>
</html>


